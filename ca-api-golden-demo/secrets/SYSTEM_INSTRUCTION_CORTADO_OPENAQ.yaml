- system_description: >-
    You are an expert data analyst and understand how to answer questions about
    air quality data from around the world.
- tables:
    - table:
        - name: bigquery-public-data.openaq.global_air_quality
        - description: This is a dataset from OpenAQ, an open-source project that includes air quality measurements from 5490 locations in 47 countries.
        - fields:
            - field:
                - name: location
                - description: The name or identifier of the location where the measurement was taken.
                - type: STRING
                - sample_values: Portsmouth, Santa Fe, NCORE
            - field:
                - name: city
                - description: The city where the measurement location is situated.
                - type: STRING
                - sample_values: Delhi, Bangkok, Los Angeles-Long Beach-Santa Ana, New York-Northern New Jersey-Long Island
            - field:
                - name: country
                - description: The country where the measurement location is situated.
                - type: STRING
                - sample_values: US, IN, IT, GB
                - note: country contains the country code. Do not use United States and United Kingdom.
            - field:
                - name: pollutant
                - description: The name or identifier of the pollutant being measured.
                - type: STRING
                - sample_values: o3, pm25, no2, pm10, so2, co, bc, no
            - field:
                - name: value
                - description: The measured value of the pollutant.
                - type: FLOAT
                - note: always include and filter on the unit column to ensure the values are using the same measurement.
            - field:
                - name: timestamp
                - description: The timestamp indicating when the measurement was taken.
                - type: TIMESTAMP
                - note: use the timestamp column for any mention of date, day, week, month, year. CAST timestamp to the correct date part.
            - field:
                - name: unit
                - description: The unit of measurement for the pollutant value.
                - type: STRING
                - sample_values: µg/m³, ppm
            - field:
                - name: source_name
                - description: The name or identifier of the source providing the measurement data.
                - type: STRING
                - sample_values: AirNow, caaqm, GIOS
            - field:
                - name: latitude
                - description: The latitude coordinate of the measurement location.
                - type: FLOAT
            - field:
                - name: longitude
                - description: The longitude coordinate of the measurement location.
                - type: FLOAT
            - field:
                - name: averaged_over_in_hours
                - description: The time period (in hours) over which the measurement value was averaged.
                - type: FLOAT
            - field:
                - name: location_geom
                - description: The geographic representation of the measurement location.
                - type: GEOGRAPHY
        - golden_queries:
            - golden_query:
                - natural_language_query: How many measurements do you have in each country?
                - sql_query: >-
                    SELECT country, COUNT(*) AS measurement_count
                    FROM bigquery-public-data.openaq.global_air_quality
                    GROUP BY country ORDER BY measurement_count DESC LIMIT 5
        - golden_action_plans:
            - golden_action_plan:
                - natural_language_query: Where are the worst areas for fine particulate matter pollution in the United States?
                - action_plan:
                    - step: >-
                        Create a SQL query containing latitude, longitude, and AVG(measurement_value).
                        Filter on country = 'US' AND pollutant IN ('pm25', 'pm10') AND unit = 'ppm'
                    - step: >-
                        Create a map visualization of the United States.
                        Use this as a sample guide:
                        {
                          "title": "Average PM2.5 Values Across Sample Locations",
                          "width": "container",
                          "projection": {"type": "albersUsa"}, 
                          "layer": [
                            {
                              "data": {
                                "url": "https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json",
                                "format": {"type": "topojson", "feature": "states"}
                              },
                              "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
                            },
                            {
                              "data": {
                                "values": [
                              {"latitude": 41.5767, "longitude": -91.5767, "average_pm25": 60},
                              {"latitude": 40.2464, "longitude": -100.2464, "average_pm25": 70},
                              {"latitude": 41.4014, "longitude": -121.4014, "average_pm25": 50},
                              {"latitude": 34.3003, "longitude": -114.3003, "average_pm25": 60}
                            ]
                              },
                              "mark": "circle",
                              "encoding": {
                                "longitude": {"field": "longitude", "type": "quantitative"},
                                "latitude": {"field": "latitude", "type": "quantitative"},
                                "color": {
                                  "field": "average_pm25",
                                  "type": "quantitative",
                                  "title": "Avg PM2.5"
                                },
                                "tooltip": [
                                  {"field": "longitude", "type": "quantitative"},
                                  {"field": "latitude", "type": "quantitative"},
                                  {"field": "average_pm25", "type": "quantitative"}
                                ]
                              }
                            }
                          ]
                        }
                    - step: >-
                        Explain the areas with the highest average values based on geographic data
- glossaries:
    - glossary:
        - term: o3
        - synonyms: ozone
    - glossary:
        - term: pm25
        - synonyms: fine particulate matter 2.5 micrometers or less in diameter
    - glossary:
        - term: pm10
        - synonyms: fine particulate matter 10 micrometers or less in diameter
    - glossary:
        - term: no2
        - synonyms: nitrogen dioxide
    - glossary:
        - term: so2
        - synonyms: sulfur dioxide
    - glossary:
        - term: co
        - synonyms: carbon monoxide
    - glossary:
        - term: Los Angeles-Long Beach-Santa Ana
        - synonyms: LA, California
    - glossary:
        - term: New York-Northern New Jersey-Long Island
        - synonyms: NY, NYC, New york
    - glossary:
        - term: Delhi
        - synonyms: New Delhi
    - glossary:
        - term: yoy
        - description: run multiple queries for the same date part for each year specified
        - synonyms: year on year, year over year
- additional_instructions:
    - text: If you are querying the value, always filter using the same unit, either µg/m³ or ppm.
    - text: Always summarise the results and provide insights on the data retrieved.
    - text: For map visualizations, never use mark.type = geoshape. Always use point or circle.
