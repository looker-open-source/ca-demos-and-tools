system_description: >-
  You are an expert data analyst and understand how to answer questions about
  the retail data for a fictitious pet super store, Cymbal Pets. Cymbal Pets is
  a Pet Super Store which has an offline, and digital presence.
tables:
  - table:
      name: looker-private-demo.cymbal_pets.customers
      description: Contains information about customers of Cymbal Pets.
      fields:
        - field:
            - name: address_city
            - description: The city of the customer's address.
            - type: STRING
            - sample_values: South Kimberly, Port Joseph
        - field:
            - name: customer_id
            - description: The unique identifier for the customer.
            - type: INTEGER
        - field:
            - name: first_name
            - description: The first name of the customer.
            - type: STRING
        - field:
            - name: last_name
            - description: The last name of the customer.
            - type: STRING
        - field:
            - name: email
            - description: The email address of the customer.
            - type: STRING
        - field:
            - name: gender
            - description: The gender of the customer.
            - type: STRING
            - sample_values: f, m
        - field:
            - name: address_state
            - description: The state of the customer's address.
            - type: STRING
        - field:
            - name: loyalty_member
            - description: Indicates whether the customer is a loyalty member.
            - type: BOOLEAN
  - table:
      name: looker-private-demo.cymbal_pets.customer_service
      description: Contains information about customer service cases.
      fields:
        - field:
            - name: customer_id
            - description: The unique identifier for the customer associated with the case.
            - type: INTEGER
        - field:
            - name: case_id
            - description: The unique identifier for the customer service case.
            - type: INTEGER
        - field:
            - name: case_type
            - description: The type or category of the customer service case.
            - type: STRING
        - field:
            - name: case_status
            - description: The current status of the customer service case.
            - type: STRING
        - field:
            - name: resolution_notes
            - description: Notes detailing the resolution of the case (nullable).
            - type: STRING
        - field:
            - name: agent_id
            - description: The unique identifier for the agent (employee) handling the case (nullable).
            - type: INTEGER
  - table:
      name: looker-private-demo.cymbal_pets.distribution_centers
      description: Contains information about distribution centers for Cymbal Pets.
      fields:
        - field:
            - name: distribution_center_id
            - description: (No description)
            - type: INTEGER
        - field:
            - name: distribution_center_name
            - description: (No description)
            - type: STRING
        - field:
            - name: address_city
            - description: (No description)
            - type: STRING
        - field:
            - name: address_state
            - description: (No description)
            - type: STRING
        - field:
            - name: latitude
            - description: (No description)
            - type: FLOAT
        - field:
            - name: longitude
            - description: (No description)
            - type: FLOAT
  - table:
      name: looker-private-demo.cymbal_pets.employees
      description: Contains information about Cymbal Pets employees.
      fields:
        - field:
            - name: employee_id
            - description: The unique identifier for the employee.
            - type: INTEGER
        - field:
            - name: first_name
            - description: The first name of the employee.
            - type: STRING
        - field:
            - name: last_name
            - description: The last name of the employee.
            - type: STRING
        - field:
            - name: job_title
            - description: The job title of the employee.
            - type: STRING
        - field:
            - name: hire_date
            - description: The date the employee was hired.
            - type: DATE
        - field:
            - name: gender
            - description: The gender of the employee.
            - type: STRING
        - field:
            - name: salary
            - description: The employee's salary.
            - type: FLOAT
  - table:
      name: looker-private-demo.cymbal_pets.nutritional_data
      description: Contains detailed nutritional information for food products.
      fields:
        - field:
            - name: food_id
            - description: The unique identifier for the food item. This likely links to the products table.
            - type: INTEGER
        - field:
            - name: food_name
            - description: The name of the food item.
            - type: STRING
        - field:
            - name: nutritional_info
            - description: Detailed nutritional information. This is a nested record.
            - type: RECORD
  - table:
      name: looker-private-demo.cymbal_pets.order_items
      description: Contains information about individual items within orders.
      fields:
        - field:
            - name: order_id
            - description: The unique identifier for the order this item belongs to.
            - type: INTEGER
        - field:
            - name: product_id
            - description: The unique identifier for the product in this order item.
            - type: INTEGER
        - field:
            - name: order_item_id
            - description: The unique identifier for this specific item within an order.
            - type: INTEGER
        - field:
            - name: quantity
            - description: The quantity of the product ordered in the order line.
            - type: INTEGER
        - field:
            - name: price
            - description: The price for the product ordered in the order line.
            - type: FLOAT
  - table:
      name: looker-private-demo.cymbal_pets.orders
      description: Contains information about orders placed at Cymbal Pets.
      fields:
        - field:
            - name: customer_id
            - description: The unique identifier for the customer who placed the order.
            - type: INTEGER
        - field:
            - name: order_id
            - description: The unique identifier for the order.
            - type: INTEGER
        - field:
            - name: shipping_address_city
            - description: The city of the shipping address for the order.
            - type: STRING
        - field:
            - name: store_id
            - description: The unique identifier for the store where the order was placed (if applicable).
            - type: INTEGER
        - field:
            - name: order_date
            - description: The date the order was placed.
            - type: DATE
        - field:
            - name: order_type
            - description: The type of the order (e.g., Online, Offline).
            - type: STRING
            - sample_values: Offline, Online
        - field:
            - name: payment_method
            - description: The payment method used for the order.
            - type: STRING
            - sample_values: Credit Card, Paypal, Invoice, Cash
  - table:
      name: looker-private-demo.cymbal_pets.pet_profiles
      description: Contains profiles of individual pets belonging to customers.
      fields:
        - field:
            - name: pet_id
            - description: The unique identifier for the pet.
            - type: INTEGER
        - field:
            - name: customer_id
            - description: The unique identifier for the customer who owns the pet.
            - type: INTEGER
        - field:
            - name: pet_name
            - description: The name of the pet.
            - type: STRING
        - field:
            - name: pet_type
            - description: The type of pet (e.g., Dog, Cat, Bird).
            - type: STRING
        - field:
            - name: age
            - description: The age of the pet in years.
            - type: INTEGER
        - field:
            - name: weight
            - description: The weight of the pet (likely in pounds or kilograms - clarify in data if possible).
            - type: INTEGER
        - field:
            - name: activity_level
            - description: The activity level of the pet (e.g., Low, Medium, High).
            - type: STRING
        - field:
            - name: dietary_needs
            - description: Any specific dietary needs or restrictions for the pet.
            - type: STRING
  - table:
      name: looker-private-demo.cymbal_pets.products
      description: Contains information about products offered by Cymbal Pets.
      fields:
        - field:
            - name: product_id
            - description: The unique identifier for the product.
            - type: INTEGER
        - field:
            - name: product_name
            - description: The name of the product.
            - type: STRING
            - sample_values: Flea Fighter Plus for Cats, Happy Birds Bird Cage
        - field:
            - name: category
            - description: The category of the product.
            - type: STRING
            - sample_values: Accessories, Food, Toys, Health & Wellness
        - field:
            - name: subcategory
            - description: The subcategory of the product.
            - type: STRING
            - sample_values: Cat Food, Aquarium Maintenance, Dog Training, Dog Food, Dog Toys, Cat Toys, Small Animal Care, Aquarium Equipment, Dog Collars & Leashes, Dog Health, Small Animal Food, Cat Beds, Flea & Tick, Small Animal Cages, Aquarium Decor, Dog Grooming, Cat Scratchers, Small Animal Toys, Cat Trees, Dog Beds, Cat Treats, Dog Treats, Dog Dental Care, Bird Food, Aquariums, Dog Travel, Bird Toys, Bird Cage Accessories, Bird Cages, Dog Waste Disposal, Cat Health
        - field:
            - name: brand
            - description: The brand of the product.
            - type: STRING
            - sample_values: AquaClear, Ocean Bites
        - field:
            - name: price
            - description: The price of the product.
            - type: FLOAT
        - field:
            - name: description
            - description: A description of the product.
            - type: STRING
        - field:
            - name: image_url
            - description: URL of an image of the product.
            - type: STRING
        - field:
            - name: inventory_level
            - description: The current inventory level of the product.
            - type: INTEGER
        - field:
            - name: supplier_id
            - description: The unique identifier of the supplier for this product.
            - type: INTEGER
        - field:
            - name: average_rating
            - description: The average customer rating for the product (nullable).
            - type: FLOAT
        - field:
            - name: nutritional_info
            - description: Detailed nutritional information for the product (if applicable).  This is a nested record.
            - type: RECORD
  - table:
      name: looker-private-demo.cymbal_pets.purchase_orders
      description: Contains information about purchase orders for Cymbal Pets.
      fields:
        - field:
            - name: supplier_id
            - description: (No description)
            - type: INTEGER
        - field:
            - name: product_id
            - description: (No description)
            - type: INTEGER
        - field:
            - name: distribution_center_id
            - description: (No description)
            - type: INTEGER
        - field:
            - name: purchase_order_id
            - description: (No description)
            - type: INTEGER
        - field:
            - name: purchase_order_date
            - description: (No description)
            - type: DATE
        - field:
            - name: purchase_delivery_date
            - description: (No description)
            - type: DATE
        - field:
            - name: quantity
            - description: (No description)
            - type: INTEGER
        - field:
            - name: price
            - description: (No description)
            - type: FLOAT
        - field:
            - name: cost
            - description: (No description)
            - type: FLOAT
  - table:
      name: looker-private-demo.cymbal_pets.stores
      description: Contains information about Cymbal Pets store locations.
      fields:
        - field:
            - name: store_id
            - description: The unique identifier for the store.
            - type: INTEGER
        - field:
            - name: store_name
            - description: The name of the store.
            - type: STRING
            - sample_values: Cymbal Pets Back Bay, Cymbal Pets Downtown
        - field:
            - name: address_state
            - description: The state where the store is located.
            - type: STRING
        - field:
            - name: address_city
            - description: The city where the store is located.
            - type: STRING
        - field:
            - name: latitude
            - description: The latitude coordinate of the store's location.
            - type: FLOAT
        - field:
            - name: longitude
            - description: The longitude coordinate of the store's location.
            - type: FLOAT
        - field:
            - name: opening_hours
            - description: Record of the store's opening hours for each day of the week (Monday, Tuesday, etc.).  This is a nested record.
            - type: RECORD
            - sample_values: 9:00 AM - 9:00 PM # Keep sample, but note this is a *record*, not a single value.
        - field:
            - name: manager_id
            - description: The ID of the store manager.
            - type: INTEGER
  - table:
      name: looker-private-demo.cymbal_pets.suppliers
      description: Contains information about Cymbal Pets' suppliers.
      fields:
        - field:
            - name: supplier_id
            - description: The unique identifier for the supplier.
            - type: INTEGER
        - field:
            - name: supplier_name
            - description: The name of the supplier.
            - type: STRING
            - sample_values: Cozy Naps Pet Products, Nibble Time Pet Food
        - field:
            - name: contact_name
            - description: The name of the contact person at the supplier.
            - type: STRING
        - field:
            - name: email
            - description: The email address of the supplier.
            - type: STRING
        - field:
            - name: phone_number
            - description: The phone number of the supplier.
            - type: STRING
        - field:
            - name: address_state
            - description: The state where the supplier is located.
            - type: STRING
        - field:
            - name: address_city
            - description: The city where the supplier is located.
            - type: STRING
        - field:
            - name: latitude
            - description: The latitude coordinate of the supplier's location.
            - type: FLOAT
        - field:
            - name: longitude
            - description: The longitude coordinate of the supplier's location.
            - type: FLOAT
glossaries:
  - glossary:
      term: sales
      description: SUM(order_items.quantity * order_items.price)
      synonyms: total sales, revenue, income
      table: looker-private-demo.cymbal_pets.order_items
  - glossary:
      term: delivery time
      description: TIMESTAMP_DIFF(purchase_orders.purchase_delivery_date, purchase_orders.purchase_order_date, DAY)
      synonyms: lead time, shipping time
      table: looker-private-demo.cymbal_pets.purchase_orders
  - glossary:
      term: cash
      description: orders.payment_method is Cash
      table: looker-private-demo.cymbal_pets.orders
  - glossary:
      term: online
      description: orders.order_type is Online
      synonyms: ecommerce
      table: looker-private-demo.cymbal_pets.orders
  - glossary:
      term: offline
      description: orders.order_type is Offline
      synonyms: in person, in store, retail
      table: looker-private-demo.cymbal_pets.orders
core_relationships:
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.customers
        - looker-private-demo.cymbal_pets.orders
      description: A customer can place one or more orders. This is a one-to-many relationship.
      join_key: customer_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.orders
        - looker-private-demo.cymbal_pets.order_items
      description: An order can contain one or more order items. Again, a one-to-many relationship.
      join_key: order_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.order_items
        - looker-private-demo.cymbal_pets.products
      description: An order item relates to exactly one product. This is a many-to-one relationship from order_items to products, or a one-to-many from products to order_items (a product can be in many order items over time).
      join_key: product_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.customers
        - looker-private-demo.cymbal_pets.customer_service
      description: A customer can have one or more customer service cases. This is a one-to-many relationship.
      join_key: customer_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.customer_service
        - looker-private-demo.cymbal_pets.employees
      description: A customer service case is handled by one agent (employee). This is a many-to-one relationship from customer_service to employees.
      join_key: agent_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.products
        - looker-private-demo.cymbal_pets.pet_profiles
      description: A product *could* be associated with one or more pet profiles, likely indicating products suitable for specific pets. It's more likely a many-to-many relationship, but without an explicit linking table, we'll describe it as potentially one-to-many.
      join_key: "No direct join key. This relationship is inferred, not enforced in the database structure."
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.customers
        - looker-private-demo.cymbal_pets.pet_profiles
      description: A customer can have one or more pet profiles associated with them. This is a one-to-many relationship.
      join_key: customer_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.orders
        - looker-private-demo.cymbal_pets.stores
      description: An order occurs at a store.
      join_key: store_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.products
        - looker-private-demo.cymbal_pets.suppliers
      description: A product is supplied by one supplier. This is a many-to-one relationship from products to suppliers.
      join_key: supplier_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.employees
        - looker-private-demo.cymbal_pets.stores
      description: An employee is associated with one store (likely where they work). This is a many-to-one relationship from employees to stores.
      join_key: "No Direct join Key, inferred through manager_id in stores table"
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.products
        - looker-private-demo.cymbal_pets.nutritional_data
      description: A product can have associated nutritional data.
      join_key: "food_id (It is assumed food_id maps to product_id in the products table)"
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.purchase_orders
        - looker-private-demo.cymbal_pets.suppliers
      description: A purchase order is placed with one supplier.
      join_key: supplier_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.purchase_orders
        - looker-private-demo.cymbal_pets.products
      description: A purchase order contains one product.
      join_key: product_id
  - entity:
      tables:
        - looker-private-demo.cymbal_pets.purchase_orders
        - looker-private-demo.cymbal_pets.distribution_centers
      description: A purchase order is associated with a distribution center.
      join_key: distribution_center_id
additional_instructions:
  - text: always summarise the results and provide insights on the data retrieved.
  - text: do not confuse orders and order_items tables. The order_items has quantity and price.
  - text: you have the ability to generate map visualizations by using vega topojson for US states and world countries. If I ask for a map, run the query and then in the chart query step, try to render the visualization.
  - text: when answering questions about customers, always exclude records where customer_id is null (i.e. only consider rows with customer_id IS NOT NULL).
  - text: >
      when generating SQL join conditions, only create joins where both tables have a column with the exact same name. For instance, you should only join order_id to order_id or product_id to product_id.
  - text: >
      ensure that table aliases reflect the actual table being joined. Do not reuse an alias from one table for a different table, even if the names appear similar.
  - text: >
      before including a join condition in the generated SQL, verify that the columns being joined are identical in name. If the column names do not match exactly, do not create the join—even if they might be semantically related.
  - text: >
      do not assume semantic similarity between differently named columns. Only include join conditions where the key names are identical.
  - text: >
      if I ask you to perform cluster analysis...
      First determine the optimal number of clusters using the elbow method and silhouette score. 
      Apply K-means clustering with the optimal number of clusters
      Then, add the cluster labels to the data. 
      Display the first 5 rows of the updated DataFrame, the number of customers in each cluster, and the cluster centers. 
      Then, generate a chart using altair to create a scatter plot with one metric on the x axis and a different metric on the y axis.
      Make the chart interactive with hover data showing customer_id and all the metrics queried. 
      Color each data point by the cluster label.
  - text: >
      always format values in the text summary. do not format numbers in the SQL query. If I ask about:
       - sales -> round to nearest integer, commas, and currency symbol
       - percentages -> give 2 decimal places
       - counts -> give integer value with commas
  - text: there are no date fields on the order_items table. Whenever you are asked to filter by date, always use orders.order_date.
    table: looker-private-demo.cymbal_pets.order_items
  - text: >
      there are only 4 products.categories: Accessories, Food, Toys, Health & Wellness
    table: looker-private-demo.cymbal_pets.products
  - text: >
      there are only 31 products.subcategory: Cat Food, Aquarium Maintenance, Dog Training, Dog Food, Dog Toys, Cat Toys, Small Animal Care, Aquarium Equipment, Dog Collars & Leashes, Dog Health, Small Animal Food, Cat Beds, Flea & Tick, Small Animal Cages, Aquarium Decor, Dog Grooming, Cat Scratchers, Small Animal Toys, Cat Trees, Dog Beds, Cat Treats, Dog Treats, Dog Dental Care, Bird Food, Aquariums, Dog Travel, Bird Toys, Bird Cage Accessories, Bird Cages, Dog Waste Disposal, Cat Health
    table: looker-private-demo.cymbal_pets.products
